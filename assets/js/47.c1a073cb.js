(window.webpackJsonp=window.webpackJsonp||[]).push([[47],{424:function(t,s,e){"use strict";e.r(s);var a=e(44),n=Object(a.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"entity-system"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#entity-system"}},[t._v("#")]),t._v(" Entity System")]),t._v(" "),e("p",[e("RouterLink",{attrs:{to:"/api/classes/entitysystem.html"}},[t._v("EntitySystem")]),t._v(" derived classes contain the logic that process our game entities.")],1),t._v(" "),e("p",[e("strong",[t._v("Make sure")]),t._v(" to check out the page about "),e("RouterLink",{attrs:{to:"/guide/core/dependency-injection.html"}},[t._v("Dependency Injection")]),t._v(".")],1),t._v(" "),e("h2",{attrs:{id:"creating-a-custom-entitysystem"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#creating-a-custom-entitysystem"}},[t._v("#")]),t._v(" Creating a Custom EntitySystem")]),t._v(" "),e("p",[t._v("In addition to extending the "),e("RouterLink",{attrs:{to:"/guide/systems/"}},[t._v("built-in entitysystems")]),t._v(", you can extend "),e("RouterLink",{attrs:{to:"/api/classes/entitysystem.html"}},[t._v("EntitySystem")]),t._v(" itself.")],1),t._v(" "),e("p",[t._v("These are some methods you might want to override.")]),t._v(" "),e("div",{staticClass:"language-typescript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-typescript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * Called when this EntitySystem is added to the engine or re-enabled after being disabled.\n */")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("onEnable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * Called when this EntitySystem is removed from the engine or being disabled.\n */")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("onDisable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/**\n * The update method called every tick.\n *\n * @param deltaTime The time passed since last frame in seconds.\n */")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("abstract")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("deltaTime"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("number")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("For instance, let us say we want to change our entities' position according to their velocity. We can create a "),e("code",[t._v("MovementSystem")]),t._v(" that takes care of it.")]),t._v(" "),e("div",{staticClass:"language-typescript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-typescript"}},[e("code",[t._v("@"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("Service")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("MovementSystem")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("EntitySystem")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("private")]),t._v(" entities"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" Entity"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\n\t"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" override "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("onEnable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("entities "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("engine"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("forFamily")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Family"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("all")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PositionComponent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" VelocityComponent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" override "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("onDisable")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("entities "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n\t"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("protected")]),t._v(" override "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("update")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("deltaTime"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("number")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("for")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" entity "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("of")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("entities"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" position "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" entity"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("PositionComponent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" velocity "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" entity"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("require")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("VelocityComponent"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\t\n\t\t\tposition"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("x "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" velocity"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("x "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" deltaTime"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t\tposition"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("y "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" velocity"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("y "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" deltaTime"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t\t"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),e("p",[t._v("Of course, the above can be simplified, by using the built-in "),e("RouterLink",{attrs:{to:"/guide/systems/iteratingsystem.html"}},[t._v("IteratingSystem")])],1),t._v(" "),e("h2",{attrs:{id:"adding-entitysystems-to-the-engine"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#adding-entitysystems-to-the-engine"}},[t._v("#")]),t._v(" Adding EntitySystems to the Engine")]),t._v(" "),e("p",[t._v("An Engine can never hold two systems of the same class. So when adding a system of the same class twice, the second will replace the first.")]),t._v(" "),e("p",[t._v("Do the following to register a system with the engine.")]),t._v(" "),e("div",{staticClass:"language-typescript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-typescript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Using the return value is of course optional")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" movementSystem "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" engine"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("systems"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MovementSystem"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h2",{attrs:{id:"removing-an-entitysystem-from-the-engine"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#removing-an-entitysystem-from-the-engine"}},[t._v("#")]),t._v(" Removing an EntitySystem From the Engine")]),t._v(" "),e("p",[t._v("Anytime you want, you can remove a system from the engine (which will effectively delete it).")]),t._v(" "),e("div",{staticClass:"language-typescript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-typescript"}},[e("code",[t._v("engine"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("systems"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("remove")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MovementSystem"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("Be careful though if you remove systems, which are still referenced in other places.")]),t._v(" "),e("p",[t._v("Removing a system from the engine will also remove it from the dependency container, so unless you have other references to the system, it should be garbage collected.")]),t._v(" "),e("h2",{attrs:{id:"updating-all-systems"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#updating-all-systems"}},[t._v("#")]),t._v(" Updating All Systems")]),t._v(" "),e("p",[t._v("A call to "),e("RouterLink",{attrs:{to:"/api/classes/engine.html#update"}},[t._v("engine.update(deltaTime)")]),t._v(" will update all the registered entity systems according to their priority order. The lower the priority level, the sooner the system will be updated. You can change the priority of a system using its "),e("RouterLink",{attrs:{to:"/api/classes/entitysystem.html#setpriority"}},[t._v("setPriority()")]),t._v(" method.")],1),t._v(" "),e("h2",{attrs:{id:"retrieving-an-entitysystem-from-the-engine"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#retrieving-an-entitysystem-from-the-engine"}},[t._v("#")]),t._v(" Retrieving an EntitySystem From the Engine")]),t._v(" "),e("p",[t._v("A system can be retrieved from an engine reference by its class.")]),t._v(" "),e("div",{staticClass:"language-typescript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-typescript"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" movementSystem "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" engine"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("systems"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MovementSystem"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h2",{attrs:{id:"enabling-disabling-entitysystems-without-removing-them"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#enabling-disabling-entitysystems-without-removing-them"}},[t._v("#")]),t._v(" Enabling/Disabling Entitysystems Without Removing Them")]),t._v(" "),e("p",[t._v("You can enable/disable systems whenever you want. So, if what you need is to temporarily pause a system, you do not need to remove and later re-add it. When a system is disabled, it will not be updated by the engine.")]),t._v(" "),e("div",{staticClass:"language-typescript extra-class"},[e("pre",{pre:!0,attrs:{class:"language-typescript"}},[e("code",[t._v("movementSystem"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("setEnabled")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h2",{attrs:{id:"built-in-entitysystems"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#built-in-entitysystems"}},[t._v("#")]),t._v(" Built-in EntitySystems")]),t._v(" "),e("p",[t._v("typed-ecstasy comes with a few abstract "),e("RouterLink",{attrs:{to:"/guide/systems/"}},[t._v("built-in entitysystems")]),t._v(" that might make your life easier and avoid some boilerplate code.")],1)])}),[],!1,null,null,null);s.default=n.exports}}]);